<html metal:use-macro="here/getHeader">

<script type="text/javascript" metal:fill-slot="extrajs"><!--
function deldraft(draftid) {
  // return true if the AJAX request failed, 
  // return false if everything went fine.
  var d = 'id='+draftid +'&return_show_drafts=1';
  var a = new sack('DeleteDraftIssue');
  a.AjaxFailedAlert=null;
  a.encodeURIString = false;
  a.runAJAX(d);
  a.onCompletion = function() { document.getElementById('issuedraftsouter').innerHTML=a.response; };
  if (a.failed) return true;
  return false;  
}
//--></script>

<style type="text/css" metal:fill-slot="extracss">
#box1 {
    float:left;
    width: 44%; /* ie5win fudge begins */
    voice-family: "\"}\"";
    voice-family:inherit;
    width: 41%;
}
html>body #box1 {
    width: 41%;
}
#box2 {
    float:right;
    width: 44%; /* ie5win fudge begins */
    voice-family: "\"}\"";
    voice-family:inherit;
    width: 41%;

}
html>body #box2 {
    width: 41%;
}


ul#further {
  margin: 0 0 0 10px;
  padding: 0;
  list-style: none;
}
ul#further li {
  margin: 2px 0 6px 0;
  padding: 0;
  font-weight: bold;
  line-height: 24px; /* height of icon */
  background-repeat: no-repeat;
  background-position: 0 50%;
}
ul#further li a {
  padding-left: 24px; /* width of icon + whitespace */
}

#statistics { background-image: url(/misc_/IssueTrackerProduct/statistics.gif); }
#reports { background-image: url(/misc_/IssueTrackerProduct/reports.gif); }



</style>

<div metal:fill-slot="body">

<div id="box1">


    <table tal:define="statuslist here/CountStatuses" tal:condition="python:len(statuslist)>0"
     summary="List of counts per different statuses"
     border="0" cellspacing="0" cellpadding="2">

      <tr class="lhead">
        <th tal:repeat="statuscount statuslist" align="center">&nbsp;&nbsp;<a tal:define="status python:statuscount[0]"
         tal:attributes="href python:here.getStatus2ListLink(status)" tal:content="python:status.capitalize()">Status</a>&nbsp;&nbsp;</th>
      </tr>
      <tr >
        <td align="center" tal:repeat="statuscount statuslist" tal:content="python:statuscount[1]">count</td>
      </tr>

      <tr>
        <td align="right" colspan=1 tal:attributes="colspan python:len(statuslist)">
          Only for the last 
          <a href="?count_status_since=1" tal:attributes="style python:test(request.has_key('count_status_since') and request['count_status_since']=='1','background-color: gainsboro;;','')">1 day</a>, 
          <a href="?count_status_since=7" tal:attributes="style python:test(request.has_key('count_status_since') and request['count_status_since']=='7','background-color: gainsboro;;','')">1 week</a> or
          <a href="?count_status_since=30" tal:attributes="style python:test(request.has_key('count_status_since') and request['count_status_since']=='30','background-color: gainsboro;;','')">1 month</a>

            <a tal:condition="python:request.has_key('count_status_since')" href="" >ever</a>

        </td>
      </tr>
</table>

  <br />
  <ul id="further">
    <li id="statistics"
     tal:condition="python:here.hasManagerRole() or not here.PrivateStatistics()"
      ><a href="Statistics">More statistics</a></li>
    <li id="reports"
     tal:condition="python:(here.hasManagerRole() or not here.PrivateReports()) and here.getReportsContainer().getScripts()"
      ><a href="Reports"
       tal:define="reportscontainer here/getReportsContainer"
       tal:attributes="href reportscontainer/absolute_url_path">Reports</a></li>  
  </ul>




</div>

<div id="outlook">


<table border="0" cellpadding="4" cellspacing="0"
     tal:define="b_size python:5;global b_size request/size | b_size; 
                 dummy python:request.set('keep_sortorder',0);
                 dummy python:request.set('sortorder',here.getDefaultSortorder());
                 dummy python:request.set('reverse',0);
                 filteredissues python:here.ListIssuesFiltered(skip_filter=1);
                 batch python:filteredissues[:b_size];
                 display_date here/display_date;"	
     tal:attributes="summary string:$b_size latest issues">
    <thead>
	<tr class="lhead">
		<td colspan="2"><span tal:replace="b_size">#</span> Latest Issues</td>
	</tr>
    </thead>
	<tbody tal:repeat="issue batch" tal:attributes="class python:test(path('repeat/issue/odd'), 'lodd','leven')">
		<tr>
			<td><span tal:condition="here/ShowIdWithTitle" class="id" tal:content="string:#${issue/id} "></span>
			   <b><a class="issuetitle" tal:attributes="href issue/relative_url; title issue/status"
                             tal:content="structure python:here.displayBriefTitle(issue.getTitle())">Title</a></b>
                             
			
			</td>
			<td><b style="color:red;" tal:content="python:issue.status.capitalize()"></b></td>
		</tr>
		<tr tal:define="threads python:issue.ListThreads();lastthread python:issue.getLastThread()"
		tal:condition="threads">
		<td colspan="2" align="right" class="smaller">&nbsp;&nbsp;&nbsp;
        <a tal:define="anchor python:len(threads)"
		tal:attributes="href string:${issue/absolute_url}#i${anchor}"><span 
        tal:replace="structure python:here.colorizeThreadChange(lastthread.title)"/></a> by 
        <span tal:replace="structure python:here.ShowNameEmail(lastthread.fromname, lastthread.email)">Nameandemail</span>
        
		</td>
		</tr>
	</tbody>
	<tr tal:condition="not:python:batch">
		<td>
			<em>None</em>
		</td>
	</tr>
	</table>


</div>

<br class="clearer"/>

  <div id="issuedraftsouter" tal:content="structure here/show_drafts"></div>


<br class="clearer"/>

</div>
</html>

